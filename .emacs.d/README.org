* Emacs Config

*NOTE THE SCREENSHOTS ARE OUT OF DATE AS I HAVE SWITCHED COLOR SCHEMES SINCE THEY WERE TAKEN*

*UPDATE COMING SOON*

[[http://i.imgur.com/97Ax7Vv.jpg][file:http://i.imgur.com/97Ax7Vv.jpg]]

** Package management

Here I set up basic package control. I add melpa, melpa-stable and org to my sources 
and then initialize the package.

#+begin_src emacs-lisp :tangle yes
  (require 'package)
  (add-to-list 'package-archives '("org" . "http://orgmode.org/elpa/"))
  (add-to-list 'package-archives '("melpa" . "http://melpa.org/packages/"))
  (add-to-list 'package-archives '("melpa-stable" . "http://stable.melpa.org/packages/"))
  (setq package-enable-at-startup nil)
  (package-initialize)
#+end_src

I use [[https://github.com/jwiegley/use-package][use-package]] for my package management. It makes it very simple to automatically 
install packages on a new system. It also allows packages to fail while still loading 
the remainder of your config file.

#+begin_src emacs-lisp :tangle yes
  (unless (package-installed-p 'use-package)
    (package-refresh-contents)
    (package-install 'use-package))
  (require 'use-package)
  (setq use-package-always-ensure t)
#+end_src

** Essential Settings

Essential settings contains mostly quality of life changes. I disable the welcome
screen as well as the welcome message in the minibuffer. I also disable the tool bar,
scroll bar and menu bar. Matching parens are shown when highlighted. The scratch
buffer is blank by default. I also set =yes-or-no-p= so that I only have to press =y=
stead of typing =yes<RET>= when prompted. Use spaces instead of tabs. If I try and 
input text with a visual selection it replaces the visual selection. Personally I'm
partial to Inconsolata (I like Fira as well) here I check if the font group is
installed before setting the font to stop any errors. I also hate it when my init
file gets littered with crap like =custom-set-variables=. So I set a custom file for
all of this crap to go.

#+begin_src emacs-lisp :tangle yes 
  (setq inhibit-splash-screen t
        inhibit-startup-message t
        inhibit-startup-echo-area-message "wolfe")
  (tool-bar-mode -1)
  (scroll-bar-mode -1)
  (menu-bar-mode -1)
  (show-paren-mode t)
  (setq initial-scratch-message "")
  (fset 'yes-or-no-p 'y-or-n-p)
  (setq-default indent-tabs-mode nil)
  (delete-selection-mode 1)
  (when (member "Inconsolata" (font-family-list))
    (add-to-list 'default-frame-alist '(font . "Inconsolata-13" ))
    (set-face-attribute 'default t :font "Inconsolata-13"))
  (setq custom-file "~/.emacs.d/custom.el")
  (load custom-file 'noerror)
#+end_src

*** Zerodark Theme

Currently I'm using [[https://github.com/NicolasPetton/zerodark-theme][zerodark theme]]. I'm also a fan of [[https://github.com/owainlewis/emacs-color-themes][sublime themes]]'s Spolsky and
[[https://github.com/hlissner/emacs-doom-theme][doom theme]]. This theme also takes care of my modeline as well (using [[https://github.com/milkypostman/powerline][powerline]]). I use
doom theme's neotree configuration but zerodark for everything else.

#+begin_src emacs-lisp :tangle yes
  (use-package zerodark-theme
    :config
    (zerodark-setup-modeline-format))
#+end_src

** Misc Functions
   
These are just some helpful functions for basic tasks.

#+begin_src emacs-lisp :tangle yes
  (defun wolfe/load-init ()
    (interactive)
    (load-file "~/.emacs.d/init.el"))
#+end_src
 
** Org Settings

I'm still getting into org mode so my settings are very basic. I enable entities so
I can type =\= followed by something like =alpha= and get the UTF-8 char \alpha. I also
set src font natively so that I can have syntax highlighting in source blocks. I
also do some fontify stuff to make my theme look better.

Org open simply opens the file with name =name= from the org folder in my dropbox. It
works on linux and windows. Dropbox return the correct path depending on my system.

Dropbox start and stop are for computers where I dont have the privileges to install
programs. This makes use of a heavily modified =.emacs.d/dropbox.py= from the official
dropbox [[https://www.dropbox.com/install-linux][site]]. The modifications include installing and symlinking =~/Dropbox= to 
=/virtual= to avoid using up disk quota.

#+begin_src emacs-lisp :tangle yes 
   (setq org-pretty-entities t
         org-src-fontify-natively t
         org-src-tab-acts-natively t
         org-src-window-setup 'current-window
         org-fontify-whole-heading-line t
         org-fontify-done-headline t
         org-fontify-quote-and-verse-blocks t
         org-ellipsis "â¤µ") 

   (defun wolfe/org-open (name)
    (interactive)
     (when (eq system-type 'gnu/linux)
       (evil-buffer-new nil (concat "~/Dropbox/org/" name ".org")))
     (when (eq system-type 'windows-nt)
       (evil-buffer-new nil (concat "C:\\Users\\Josh\\Dropbox\\org\\" name ".org"))))

   (defun wolfe/org-dropbox-path ()
     (interactive)
     (cond
      ((eq system-type 'gnu/linux)
       "~/Dropbox/org/")
      ((eq system-type 'windows-nt)
       "C:\\Users\\Josh\\Dropbox\\org\\")
      (else "")))

   (defun wolfe/dropbox-start ()
     (interactive)
     (if (eq nil (file-exists-p "/virtual/wolfejos/dropbox/.dropbox-dist"))
         (call-process-shell-command "(python ~/.emacs.d/dropbox.py start -i&)")
       (call-process-shell-command "(python ~/.emacs.d/dropbox.py start&)")))

   (defun wolfe/dropbox-stop ()
     (interactive)
     (call-process-shell-command "python ~/.emacs.d/dropbox.py stop&"))
#+end_src

#+begin_src emacs-lisp :tangle yes 
  (use-package ox-twbs)
#+end_src

*** Org Bullets

[[org-bullets][file:http://i.imgur.com/8w3Qwgd.jpg]]


Org bullets allows for nicely formatted bullets instead of asteriks' in org mode.

#+begin_src emacs-lisp :tangle yes 
;; Better looking org headers
(use-package org-bullets
  :config
  (add-hook 'org-mode-hook (lambda () (org-bullets-mode 1))))
#+end_src

** Evil

[[https://www.emacswiki.org/emacs/Evil][Evil mode]] brings all of vim's wonderful modal editing to emacs. My evil configuration
is fairly straightforward. First I unbint =C-u= so evil can make use of it. Then I
replace =j= and =k= with their visual line mode equivilants. I have splits open on the
other side and I have it so that typing =:e<space>= triggers ido.

I use [[https://github.com/noctuid/general.el][general]] instead of [[https://github.com/cofi/evil-leader][evil leader]] for my leader key.

#+begin_src emacs-lisp :tangle yes 
  (use-package general)

  (use-package evil
    :demand
    :init
    (setq evil-want-C-u-scroll t)
    :config
    (evil-mode t)
    (setq evil-split-window-below t)
    (setq evil-vsplit-window-right t)
    (evil-ex-define-cmd "re[load]" 'wolfe/load-init)
    (define-key evil-ex-map "e " 'ido-find-file)

    (global-unset-key (kbd "M-SPC"))

    (general-create-definer wolfe/bind-leader
                            :keymaps 'global
                            :states '(normal insert emacs)
                            :prefix "SPC"
                            :non-normal-prefix "M-SPC")

    :general
    (:states 'motion
             "k" 'evil-previous-visual-line
             "j" 'evil-next-visual-line)

    (:states 'normal
             "C-S-h" help-map
             "C-h"  'evil-window-left
             "C-j"  'evil-window-down
             "C-k"  'evil-window-up
             "C-l"  'evil-window-right)

    (wolfe/bind-leader
     "w" 'save-buffer
     "S" 'eval-buffer 
     "s" 'eval-defun
     "b" 'mode-line-other-buffer
     "k" 'kill-buffer
     "m" 'ido-switch-buffer
     "os" (lambda() (interactive) (wolfe/org-open "school"))
     "ol" (lambda() (interactive) (wolfe/org-open "life"))
     "init" (lambda() (interactive) (evil-buffer-new nil "~/.emacs.d/README.org"))))
#+end_src

*** Evil Surround

[[https://github.com/timcharper/evil-surround][Evil surround]] is a copy of [[https://github.com/tpope/vim-surround][tpope's vim-surround]]. It provides text objects for common
delimiter operations. Such as wrapping a text object in quotes or brackets.

#+begin_src emacs-lisp :tangle yes 
(use-package evil-surround
  :config
  (global-evil-surround-mode 1))
#+end_src

*** Evil Magit

[[https://github.com/justbur/evil-magit][Evil magit]] and provides some nice vimish bindings in magit.
(More on magit down [[Magit][below]])

#+begin_src emacs-lisp :tangle yes 
(use-package evil-magit)
#+end_src

** General Packages
*** Ido

[[ido][file:http://i.imgur.com/VBHYTj8.jpg]]
(above is normal ido | below is with vertical mode)
[[vertical][file:http://imgur.com/NZubpFB.jpg]]

[[https://www.gnu.org/software/emacs/manual/ido.html][ido]] is my go-to minibuffer completion. It makes it super easy to navigate around the
minibuffer. I bind tab to cycle through the matches and I have fuzzy matching on as
well. I use [[https://github.com/DarwinAwardWinner/ido-ubiquitous][ido-ubiquitous]] so that I can use ido everywhere possible. Finally I have
[[https://github.com/doitian/ido-complete-space-or-hyphen][ido-complete-space-or-hyphen]] which intelligently inserts a space or hyphen based on
completion candidates. [[https://github.com/creichert/ido-vertical-mode.el][ido-vertical-mode]] doesn't affect the functionality in any way
it just displays the completion candidates in a vertical list. I simply prefer the
aesthetic.

#+begin_src emacs-lisp :tangle yes 
  (use-package ido
      :init
      (defun wolfe/ido-set-keys ()
          "Add keybindings for ido"
          (define-key ido-completion-map [tab] 'ido-next-match))
      (add-hook 'ido-setup-hook #'wolfe/ido-set-keys)
      :config
      (setq ido-enable-flex-matching t)
      (setq ido-everywhere t)
      (ido-mode 1))

  (use-package ido-ubiquitous
    :config
    (ido-ubiquitous-mode 1))

  (use-package ido-complete-space-or-hyphen)

  ;(use-package ido-vertical-mode
  ;  :config
  ;  (ido-vertical-mode 1))
#+end_src

*** Smex

[[smex][file:http://i.imgur.com/iw3gUPU.jpg]]


[[https://github.com/nonsequitur/smex][Smex]] uses ido for =M-x=. I like this for all the same reasons I like ido. Easy command
completion.

#+begin_src emacs-lisp :tangle yes 
  (use-package smex
    :config
    (global-set-key (kbd "M-x") 'smex)
    (global-set-key (kbd "M-X") 'smex-major-mode-commands)
    (global-set-key (kbd "C-c C-c M-x") 'execute-extended-command))
#+end_src

*** nLinum Relative

#+begin_src emacs-lisp :tangle yes 
  (use-package nlinum-relative
    :config
    (setq nlinum-relative-redisplay-delay 0)
    (nlinum-relative-setup-evil)
    (add-hook 'prog-mode-hook 'nlinum-relative-mode))
#+end_src

*** Expand Region

[[expandregion][file:http://i.imgur.com/ieX2sDR.jpg]]

[[https://github.com/magnars/expand-region.el][Expand reigon]] allows selection by syntastic region. So if I had an expression like this:
=(setq some-var "a string o|f chars")= with mu cusor where the =|= is. Pressing =C-==
enables the mode and selects the word =of=. Then if I press =+= it would select the 
contents in the quotes. Pressing =+= again would then select everything inside the 
quotes and the quotes themselves and so on. Pressing =-= at will do the opposite and
shrink the select region.

#+begin_src emacs-lisp :tangle yes 
  (use-package expand-region
    :config
    (global-set-key (kbd "C-=") 'er/expand-region))
#+end_src

*** Magit

[[magit][file:http://i.imgur.com/LPCrkE6.jpg]]

[[https://magit.vc/][Magit]] is a fantastic git porcelen inside of emacs. It allows you to do all of the things
you could do from the git command line from within emacs. It has mneumonic keybindings and
displays all the information very nicely. 

#+begin_src emacs-lisp :tangle yes 
  (use-package magit
    :config
    (global-set-key "\C-x\g" 'magit-status))
#+end_src

*** Ace Jump Mode

[[ace-jump-1][file:http://i.imgur.com/WjvrLff.jpg]][[ace-jump-2][file:https://s15.postimg.org/uh7612v97/acejump2.jpg]]

[[https://github.com/winterTTr/ace-jump-mode][Ace jump mode]] allows for easy movement around the buffer. It allows you to specify a character
or the first word of a character. It then dims the buffer and replaces the specified chars
with a red letter. You can then press one of the letters  to jump to the corresponding
character.

#+begin_src emacs-lisp :tangle yes 
  (use-package ace-jump-mode
    :config
    (define-key global-map (kbd "C-c C-SPC") 'ace-jump-mode))
#+end_src

*** Neotree

[[neotree][file:http://i.imgur.com/Tcw6QpF.jpg]]

[[https://www.emacswiki.org/emacs/NeoTree][Neotree]] is a file tree display which is similar to the ones found in other popular text
editors and IDEs (such as Sublime, Atom, Eclipse or nerdTREE if you use vim). It allows
you to neatly view your file structure at the side of your screen.    

#+begin_src emacs-lisp :tangle yes 
  (use-package neotree
    :config
    (global-set-key [f8] 'neotree-toggle)
    (add-hook 'neotree-mode-hook
        (lambda ()
          (define-key evil-normal-state-local-map (kbd "TAB") 'neotree-enter)
          (define-key evil-normal-state-local-map (kbd "SPC") 'neotree-enter)
          (define-key evil-normal-state-local-map (kbd "q") 'neotree-hide)
          (define-key evil-normal-state-local-map (kbd "RET") 'neotree-enter))))
#+end_src

Although I use zerodark for my colorscheme I like the neotree configuration from doom theme
so I'm using just the neotree theme. The file icons all come from the [[https://github.com/domtronn/all-the-icons.el][all the icons]] fonts 
(it doesn't actually use the all the icons package).

#+begin_src emacs-lisp :tangle yes 
  (use-package doom-neotree
    :ensure doom-themes
    :config
    (setq doom-neotree-enable-file-icons t))
#+end_src

*** Smooth Scrolling

[[https://github.com/aspiers/smooth-scrolling][Smooth scrolling]] stops emacs from jumping half of a page when you reach the bottom. It
also starts scrolling a few lines from the bottom so you don't have to scroll past what
you want.  
    
#+begin_src emacs-lisp :tangle yes 
  (use-package smooth-scrolling
    :config
    (smooth-scrolling-mode 1)
    (setq smooth-scroll-margin 3))
#+end_src
    
*** Git Gutter Fringe
    
This is a nice little visual indicator for showing what changes you've made to the file.

#+begin_src emacs-lisp :tangle yes 
  (use-package git-gutter-fringe
    :ensure t
    :diminish git-gutter-mode
    :config
    (setq git-gutter-fr:side 'right-fringe)
    (set-face-foreground 'git-gutter-fr:modified "#63747c")
    (set-face-foreground 'git-gutter-fr:added    "#63747c")
    (set-face-foreground 'git-gutter-fr:deleted  "#63747c")
    (global-git-gutter-mode +1))
#+end_src

** Language Specific
*** Latex
    
I like using latx for writing papers and taking notes. I use the built in tex mode for
syntax highlighting and [[Company Math]] (lower in my config under the company heading).

I like being able to see the changes I make in real time so I can adjust my formatting on
the fly. [[https://github.com/jsinglet/latex-preview-pane][latex preview pane]] is great for this.

#+begin_src emacs-lisp :tangle yes 
  (use-package latex-preview-pane)
#+end_src

** Company Mode

[[company][file:http://i.imgur.com/VHZzzXI.jpg]]

[[http://company-mode.github.io/][Company]] is an autocompletion framwork that supports user written backends. This means
that the number of languages company (and supporting packages) encompass is very
impressive. 

I have set the delay that company waits before completing to 0 and I also have it 
configured so that company begins completing after you type a single character. I also
set the completion list to wrap around so you can cycle through all of the completion
candidates. I've bound tab to move to the next completion candidate.

The custom faces inherit the colors from your loaded theme and match the company drop
down. This allows me to change themes without worrying that company will look terrible.

#+begin_src emacs-lisp :tangle yes 
  (use-package company
    :init
    (global-company-mode)
    :config
    (setq company-idle-delay 0)
    (setq company-minimum-prefix-length 1)
    (setq company-selection-wrap-around t)
    (define-key company-active-map [tab] 'company-select-next)

    (require 'color)
    (let ((bg (face-attribute 'default :background)))
      (custom-set-faces
       `(company-tooltip ((t (:inherit default :background ,(color-lighten-name bg 2)))))
       `(company-scrollbar-bg ((t (:background ,(color-lighten-name bg 10)))))
       `(company-scrollbar-fg ((t (:background ,(color-lighten-name bg 5)))))
       `(company-tooltip-selection ((t (:inherit font-lock-function-name-face))))
       `(company-tooltip-common ((t (:inherit font-lock-constant-face)))))))
#+end_src

*** Company Quickhelp

[[quickhelp][file:http://i.imgur.com/7mvXbqe.jpg]]

[[https://github.com/expez/company-quickhelp][Company quickhelp]] mimics the functionality of autocomplete and displays the documentation
of the currently highlighted completion (after a brief delay). This is quite handy as it
makes it easy to check the arguments or return type of the function.

#+begin_src emacs-lisp :tangle yes
  (use-package company-quickhelp
    :config
    (company-quickhelp-mode 1))
#+end_src

*** Company Math
    
[[https://github.com/vspinu/company-math][Company math]] provides completion for latex as well as all of the latex and UTF-8 symbols.

#+begin_src emacs-lisp :tangle yes
    (use-package company-math
      :config
      (defun wolfe/latex-setup ()
        (setq-local company-backends
                    (append '((company-math-symbols-latex company-latex-commands))
                            company-backends)))

      (add-hook 'tex-mode-hook 'wolfe/latex-setup))

#+end_src

** Backup Options

The default options for filebackups and autosave are terrible and leave files scattered
all across your file system. First I make all backups copy the files which stops any
shinanigans with links. I also set the backup directory. Then I check if =~/.bak.emacs/=
and =~/.bak.emacs/backup/= exit if they don't I create them. Then I set my auto save 
location to =~/.bak.emacs/auto/= and set it so that the files are are all saved in auto
with a flat structure rather rather than folder trees.

#+begin_src emacs-lisp :tangle yes 
  (setq backup-by-copying t)
  (setq backup-directory-alist '((".*" . "~/.bak.emacs/backup/")))
  (if (eq nil (file-exists-p "~/.bak.emacs/"))
      (make-directory "~/.bak.emacs/"))
  (if (eq nil (file-exists-p "~/.bak.emacs/auto"))
      (make-directory "~/.bak.emacs/auto"))
  (setq auto-save-file-name-transforms '((".*" "~/.bak.emacs/auto/" t)))
#+end_src

** Tesing / The Lab

Here is stuff that is either under testing or not meant for the public eye.

#+begin_src emacs-lisp :tangle yes 
  (if (eq t (file-exists-p "~/.emacs.d/lisp/the-lab.el"))
      (load-file "~/.emacs.d/lisp/the-lab.el"))
#+end_src 

